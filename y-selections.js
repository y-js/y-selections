!function e(t,o,n){function r(s,l){if(!o[s]){if(!t[s]){var c="function"==typeof require&&require;if(!l&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){var o=t[s][1][e];return r(o?o:e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t){var o,n;if(n=function(e,t,o){var r,i;null==o&&(o=!0);for(r in e)if(i=e[r],null==t[r]||t[r]!==i)return!1;return o?n(t,e,!1):!0},o=function(){function e(){this._listeners=[],this._composition_value=[],this._lists=[]}return e.prototype._name="Selections",e.prototype._getModel=function(e,t){return null==this._model&&(this._model=new t.Composition(this,[]).execute()),this._model},e.prototype._setModel=function(e){this._model=e},e.prototype._getCompositionValue=function(){var e,t,o,n;return t={},e=function(){var e,r,i,s;for(i=this._composition_value,s=[],o=e=0,r=i.length;r>e;o=++e)n=i[o],t[""+o+"/from"]=n.from,t[""+o+"/to"]=n.to,s.push({attrs:n.attrs});return s}.call(this),{composition_value:e,composition_value_operations:t}},e.prototype._setCompositionValue=function(e){var t,o,n,r;for(r=[],o=0,n=e.length;n>o;o++)t=e[o],t.type="select",r.push(this._apply(t));return r},e.prototype._apply=function(e){var t,o,n,r,i,s,l,c,u,f,a,p,h,m,_,v,y,d,g,w,x,b,N,P,C,E,F,Y,D,S,V,k;if(P=[],e.from.isDeleted()&&(e.from=e.from.getNext()),e.to.isDeleted()&&(e.to=e.to.getPrev()),f=e.from,b=e.to,f.getPrev()===b)return P;if("select"===e.type){for(y=f.getParent(),d=!1,S=this._lists,E=0,Y=S.length;Y>E;E++)if(v=S[E],y===this._lists[v]){d=!0;break}d||(this._lists.push(y),y.observe(function(e){return function(t){var o,n,r,i,s,l,c,u;for(u=[],l=0,c=t.length;c>l;l++)if(o=t[l],"delete"===o.type){if(null!=o.reference.selection)if(i=o.reference,s=i.selection,delete i.selection,s.from===i&&s.to===i)e._removeFromCompositionValue(s);else if(s.from===i)r=i.getNext(),s.from=r,r.selection=s;else{if(s.to!==i)throw new Error("Found weird inconsistency! Y.Selections is no longer safe to use!");n=i.getPrev(),s.to=n,n.selection=s}n=o.reference.getNext(),null!=n.selection?u.push(e._combine_selection_to_left(n.selection)):u.push(void 0)}else u.push(void 0);return u}}(this)))}for(_={from:f,to:b,type:e.type,attrs:e.attrs},V=this._listeners,F=0,D=V.length;D>F;F++)a=V[F],a.call(this,_);r=function(e){return function(t,o,n){var r,i,s,l;i={};for(r in n)l=n[r],i[r]=l;return s={from:t,to:o,attrs:i},e._composition_value.push(s),s}}(this),u=function(t){var o,n,r,i,s,l,c,u,f,a,p;if("unselect"===e.type){for(n={},f=e.attrs,c=0,u=f.length;u>c;c++)o=f[c],null!=t.attrs[o]&&(n[o]=t.attrs[o]),delete t.attrs[o];return P.push({from:e.from,to:e.to,attrs:n,type:"select"})}if(n={},r=[],s=!1,i=!1,null!=e.overwrite&&e.overwrite){a=t.attrs;for(o in a)l=a[o],null==e.attrs[o]&&(i=!0,n[o]=l);for(o in n)l=n[o],delete t.attrs[o]}p=e.attrs;for(o in p)l=p[o],null!=t.attrs[o]?(n[o]=t.attrs[o],i=!0):(r.push(o),s=!0),t.attrs[o]=l;return i&&P.push({from:t.from,to:t.to,attrs:n,type:"select"}),s?P.push({from:t.from,to:t.to,attrs:r,type:"unselect"}):void 0},i=function(){var e,t,o,n;if(null==f.selection||f.selection.from!==f){for(t=f.getPrev();null==t.selection&&"Delimiter"!==t.type;)t=t.getPrev();if(null!=t.selection&&t.selection.to!==t){for(o=t.selection,t=f;t!==o.to&&t!==b;)t=t.getNext();return t===o.to?(e=r(f,o.to,o.attrs),o.to=f.getPrev(),o.to.selection=o,e.from.selection=e,e.to.selection=e):(e=r(f,b,o.attrs),n=r(b.getNext(),o.to,o.attrs),o.to=f.getPrev(),o.to.selection=o,n.from.selection=n,n.to.selection=n,e.from.selection=e,e.to.selection=e)}}},i(),s=function(){var e,t,o;if(null==b.selection||b.selection.to!==b){for(t=b;null==t.selection&&t!==f;)t=t.getPrev();if(null!=t.selection&&t.selection.to!==t)return o=t.selection,e=r(b.getNext(),o.to,o.attrs),o.to=b,o.to.selection=o,e.from.selection=e,e.to.selection=e}},s(),l=!1;for(t in e.attrs){l=!0;break}for(h=f,N=b.getNext();h!==N;)if(null!=h.selection){u(h.selection,e),g=h.selection,this._combine_selection_to_left(g),h=g.to.getNext(),w=!0;for(o in g.attrs){w=!1;break}w&&this._removeFromCompositionValue(g)}else{for(x=h,m=h.getNext();null==m.selection&&h!==b;)h=m,m=h.getNext();if(c=h,"unselect"!==e.type&&l){n=[],k=e.attrs;for(p in k)C=k[p],n.push(p);P.push({from:x,to:c,attrs:n,type:"unselect"}),g=r(x,c,e.attrs),x.selection=g,c.selection=g,this._combine_selection_to_left(h.selection)}h=h.getNext()}return null!=h.selection&&this._combine_selection_to_left(h.selection),null!=f.selection&&this._combine_selection_to_left(f.selection),P},e.prototype._removeFromCompositionValue=function(e){return this._composition_value=this._composition_value.filter(function(t){return t!==e}),delete e.from.selection,delete e.to.selection},e.prototype._combine_selection_to_left=function(e){var t,o;if(t=e.from.getPrev(),null==t.selection);else if(n(t.selection.attrs,e.attrs))return o=t.selection.from,this._removeFromCompositionValue(t.selection),e.from!==e.to&&delete e.from.selection,e.from=o,o.selection=e},e.prototype._unapply=function(e){var t,o,n;for(o=0,n=e.length;n>o;o++)t=e[o],this._apply(t)},e.prototype.select=function(e,t,o,n){var r,i,s,l;l=0;for(r in o){l++;break}if(!(0>=l)||null!=n&&n)return s={from:e,to:t},i={attrs:o,type:"select"},null!=n&&n&&(i.overwrite=!0),this._model.applyDelta(i,s)},e.prototype.unselectAll=function(e,t){return select(e,t,{},!0)},e.prototype.unselect=function(e,t,o){var n,r;if("string"==typeof o&&(o=[o]),o.constructor!==Array)throw new Error("Y.Selections.prototype.unselect expects an Array or String as the third parameter (attributes)!");return o.length<=0?void 0:(r={from:e,to:t},n={attrs:o,type:"unselect"},this._model.applyDelta(n,r))},e.prototype.getSelections=function(e){var t,o,n,r,i,s,l,c,u;if(r=e.ref(0),null==r)return[];for(l=null,i=0,s=[];null!=r.next_cl;)if(r.isDeleted())null!=r.selection&&console.log("You forgot to delete the selection from this operation! Please write an issue how to reproduce this bug! (it could lead to inconsistencies!)"),r=r.next_cl;else{if(null!=r.selection){if(r.selection.from===r){if(null!=l)throw new Error("Found two consecutive from elements. The selections are no longer safe to use! (contact the owner of the repository)");l=i}if(r.selection.to===r){if(null==l)throw new Error("Found two consecutive to elements. The selections are no longer safe to use! (contact the owner of the repository)");n=0,t={},u=r.selection.attrs;for(o in u)c=u[o],t[o]=c;s.push({from:l,to:i,attrs:t}),l=null}else if(r.selection.from!==r)throw new Error("This reference should not point to this selection, because the selection does not point to the reference. The selections are no longer safe to use! (contact the owner of the repository)")}i++,r=r.next_cl}return s},e.prototype.observe=function(e){return this._listeners.push(e)},e.prototype.unobserve=function(e){return this._listeners=this._listeners.filter(function(t){return e!==t})},e}(),"undefined"!=typeof window&&null!==window){if(null==window.Y)throw new Error("You must first import Y!");window.Y.Selections=o}"undefined"!=typeof t&&null!==t&&(t.exports=o)},{}]},{},[1]);